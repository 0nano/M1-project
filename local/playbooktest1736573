---
- name: Déploiement de machines virtuelles sur VMware Workstation
  hosts: localhost
  gather_facts: false

  vars:
    vm_name: "BASTION"
    vm_template: "/mnt/c/Users/guiro/OneDrive/Documents/Virtual Machines/BASTION/BASTION.vmx"
    workstation_path: "/mnt/c/Program Files (x86)/VMware/VMware Workstation"

  tasks:
    - name: Démarrer la machine virtuelle
      command: >
        "{{ workstation_path }}/vmrun" start "{{ vm_template }}" nogui
      become: true

    - name: Attendre que la machine virtuelle démarre
      wait_for:
        timeout: 300
        delay: 10
        host: localhost
        port: 22
        state: started

    - name: Exécuter d'autres tâches après le démarrage (ajoutez vos tâches ici)
      debug:
        msg: "La machine virtuelle a démarré avec succès."
